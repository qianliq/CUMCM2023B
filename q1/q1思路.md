# 推导

### **问题1：建立多波束测深的覆盖宽度及相邻条带之间重叠率的数学模型（通用形式）**

#### **已知条件（符号化）：**
- 多波束换能器开角：$ 	heta $（通常指总开角）
- 海底坡度：$ \alpha $
- 测线方向与海底坡面法向在水平面的投影垂直（即测线方向平行于等深线方向）
- 在"与测线方向垂直的竖直平面"内，海底为一条与水平面夹角为 $ \alpha $ 的直线。
- 测量船位于某点，其正下方水深为 $ D $（该 $ D $ 可随测线位置 $ x $ 变化）。

---

## **计算方法总览**

本问题采用了多种方法进行覆盖宽度计算和验证：

### **方法1：解析几何方法（主要方法）**
基于严格的数学推导，建立精确的解析公式。这是理论计算的基础。

### **方法2：数值积分方法**
通过数值积分验证解析解的正确性，适用于复杂几何情况。

### **方法3：蒙特卡洛模拟方法**
利用统计采样模拟声波传播，提供概率视角的结果验证。

### **方法4：有限元方法**
将区域离散化，通过网格计算近似解，适合复杂边界条件。

### **方法5：几何模拟方法（新增）**
采用直接几何画图的思路，通过光线追踪等方法模拟声波传播，更加直观易懂。

---

## **一、坐标系与几何设定**

我们考虑一个**竖直平面**，该平面：
- 垂直于测线方向
- 包含测量船的位置和其正下方的海底点

在此平面内：
- 设测量船正下方为原点 $ O $
- 垂直向下为 $ z $ 轴正方向（深度方向）
- 水平方向（多波束扫描方向）为 $ y $ 轴

### **1. 海底面方程**

由于海底具有坡度 $ \alpha $，且测线方向与坡度方向垂直，因此在该竖直平面内，海底是一条斜线。

假设：当 $ y = 0 $ 时，水深为 $ D $。若海底向 $ +y $ 方向上升（即东边浅），则水深随 $ y $ 增大而减小。

因此，任意位置 $ y $ 处的**水深**（从海面到海底的距离）为：

$$
z_{	ext{seabed}}(y) = D - y \cdot 	an \alpha
$$

> 注意：若 $ \alpha > 0 $，且 $ y > 0 $ 表示向"上坡"方向，则水深减小。

---

### **2. 多波束声线路径**

多波束换能器发射声波，左右两侧最大波束与**垂直方向**的夹角均为 $ 	heta/2 $。

我们只考虑左右边界波束（决定覆盖宽度）：

#### 左侧波束（向 $ -y $ 方向，角度 $ -	heta/2 $）：
- 方向向量：$ (\sin(-	heta/2), \cos(-	heta/2)) = (-\sin(	heta/2), \cos(	heta/2)) $
- 参数方程（$ t \geq 0 $）：
  $$
  y_L(t) = -t \sin(\theta/2), \quad z_L(t) = t \cos(\theta/2)
  $$

#### 右侧波束（向 $ +y $ 方向，角度 $ +\theta/2 $）：
- $ y_R(t) = t \sin(\theta/2), \quad z_R(t) = t \cos(\theta/2) $

---

## **二、求声线与海底的交点**

将声线代入海底方程 $ z = D - y \tan \alpha $，求交点。

---

### **1. 左侧交点（$ -\theta/2 $ 方向）**

$$
z_L(t) = z_{\text{seabed}}(y_L(t))
\Rightarrow t \cos(\theta/2) = D - \left(-t \sin(\theta/2)\right) \cdot \tan \alpha
$$

$$
t \cos(\theta/2) = D + t \sin(\theta/2) \tan \alpha
$$

$$
t \left[ \cos(\theta/2) - \sin(\theta/2) \tan \alpha \right] = D
$$

解得：
$$
t_L = \frac{D}{\cos(\theta/2) - \sin(\theta/2) \tan \alpha}
$$

对应的横向坐标：
$$
y_L = -t_L \sin(\theta/2) = -\frac{D \sin(\theta/2)}{\cos(\theta/2) - \sin(\theta/2) \tan \alpha}
$$

---

### **2. 右侧交点（$ +\theta/2 $ 方向）**

$$
z_R(t) = z_{\text{seabed}}(y_R(t))
\Rightarrow t \cos(\theta/2) = D - \left(t \sin(\theta/2)\right) \cdot \tan \alpha
$$

$$
t \cos(\theta/2) = D - t \sin(\theta/2) \tan \alpha
$$

$$
t \left[ \cos(\theta/2) + \sin(\theta/2) \tan \alpha \right] = D
$$

解得：
$$
t_R = \frac{D}{\cos(\theta/2) + \sin(\theta/2) \tan \alpha}
$$

对应的横向坐标：
$$
y_R = t_R \sin(\theta/2) = \frac{D \sin(\theta/2)}{\cos(\theta/2) + \sin(\theta/2) \tan \alpha}
$$

---

## **三、覆盖宽度 $ W $ 的通用公式**

覆盖宽度为左右交点之间的**水平距离**：

$$
W = y_R - y_L = \frac{D \sin(\theta/2)}{\cos(\theta/2) + \sin(\theta/2) \tan \alpha} - \left( -\frac{D \sin(\theta/2)}{\cos(\theta/2) - \sin(\theta/2) \tan \alpha} \right)
$$

$$
W = D \sin(\theta/2) \left[ \frac{1}{\cos(\theta/2) + \sin(\theta/2) \tan \alpha} + \frac{1}{\cos(\theta/2) - \sin(\theta/2) \tan \alpha} \right]
$$

令：
- $ A = \cos(\theta/2) $
- $ B = \sin(\theta/2) \tan \alpha $

则：
$$
W = D \sin(\theta/2) \left( \frac{1}{A + B} + \frac{1}{A - B} \right) = D \sin(\theta/2) \cdot \frac{2A}{A^2 - B^2}
$$

代回：
$$
W = D \sin(\theta/2) \cdot \frac{2 \cos(\theta/2)}{\cos^2(\theta/2) - \sin^2(\theta/2) \tan^2 \alpha}
$$

利用 $ 2 \sin x \cos x = \sin(2x) $，分子为：
$$
2 \sin(\theta/2) \cos(\theta/2) = \sin \theta
$$

所以：
$$
\boxed{
W = \frac{D \sin \theta}{\cos^2(\theta/2) - \sin^2(\theta/2) \tan^2 \alpha}
}
$$

---

### **可选化简：用 $ \sec $ 或 $ \cos $ 表示**

也可以写成：

$$
W = D \sin(\theta/2) \left( \frac{1}{\cos(\theta/2) + \sin(\theta/2) \tan \alpha} + \frac{1}{\cos(\theta/2) - \sin(\theta/2) \tan \alpha} \right)
$$

这是最清晰的**通用解析表达式**。

---

## **四、水深 $ D $ 随测线位置的变化**

设测线方向为 $ x $ 轴，中心点 $ x = 0 $ 处水深为 $ D_0 $。

由于海底坡度为 $ \alpha $，且测线方向与坡度方向垂直（即沿等深线方向），但当我们沿 $ x $ 移动时，实际上是在沿着坡面的“走向”移动，但由于地形是平面，$ D $ 会随 $ x $ 线性变化。

> 注意：虽然测线方向与坡度法向投影垂直，但若海底是倾斜平面，则沿任何方向移动都会导致水深变化，除非严格沿等深线。

但题目中“与测线方向垂直的平面和海底坡面的交线构成一条与水平面夹角为 $ \alpha $ 的斜线”，说明在该剖面内坡度为 $ \alpha $，因此沿测线方向（与其垂直）移动时，水深变化率取决于该方向的梯度。

实际上，若海底是倾斜平面，坡度为 $ \alpha $，法向方向的坡度最大，而与其垂直的方向（即测线方向）**水深不变**？

这与题目中“计算不同 $ x $ 处的水深”矛盾。

重新审视题目：

> “计算表1中所列位置的指标值”，其中 $ x $ 是“测线距中心点处的距离”，说明这些是**不同测线的位置**，每条测线位于不同的 $ x $ 处，而每条测线处的水深不同。

这表明：**测线是平行的，沿 $ y $ 方向**，而 $ x $ 是横向坐标，沿 $ x $ 方向水深变化。

因此，海底倾斜方向在 $ x $-$z $ 平面内，坡度为 $ \alpha $，即：

$$
D(x) = D_0 - x \cdot \tan \alpha
$$

> 若 $ x > 0 $ 表示向“上坡”方向（如东边浅），则水深减小。

所以，**通用模型中，水深是位置 $ x $ 的函数**：

$$
\boxed{D(x) = D_0 - x \tan \alpha}
$$

---

## **五、覆盖宽度的最终通用模型**

将 $ D(x) $ 代入 $ W $ 的表达式：

$$
\boxed{
W(x) = \left[ \frac{\sin(\theta/2)}{\cos(\theta/2) + \sin(\theta/2) \tan \alpha} + \frac{\sin(\theta/2)}{\cos(\theta/2) - \sin(\theta/2) \tan \alpha} \right] \cdot (D_0 - x \tan \alpha)
}
$$

或更简洁地：

$$
\boxed{
W(x) = k(\theta, \alpha) \cdot D(x)
}
$$

其中：
$$
k(\theta, \alpha) = \sin(\theta/2) \left( \frac{1}{\cos(\theta/2) + \sin(\theta/2) \tan \alpha} + \frac{1}{\cos(\theta/2) - \sin(\theta/2) \tan \alpha} \right)
$$

---

## **六、相邻条带重叠率的数学模型**

### **几何关系图示**

```
                测量船1          测量船2
                  |               |
                  |               |
            ......|.......θ/2.....|.......
           .      |     /    \    |      .
          .       |    /      \   |       .
         .        |   /        \  |        .
        B         G  H          F  G'       I
        |---------|--|----------|--|-------|
        |    左1   |  |  重叠区  |  |  右2  |
        |---------|--|----------|--|-------|
              海底坡面（坡度α）
              
说明：
- 测量船1在位置x-d，测量船2在位置x
- B、I分别为左右测线的覆盖边界
- G、G'为两测线在海底的投影点
- H、F为重叠区域的边界点
- HF为重叠区域长度
- 重叠率η = HF/HI（相对于测量船2的右侧覆盖宽度）
```

### **重叠率定义与推导**

根据图片中的重叠率计算原理，海域中心点 $x$ 处的测线与相邻测线条带的重叠率 $\eta$ 定义为：

$$
\eta = \frac{HF}{HI}
$$

其中：
- $HF$：相邻条带的重叠区域长度
- $HI$：该测线的右侧覆盖宽度

### **关键几何量计算**

根据前面推导的覆盖宽度公式和几何关系：

#### **1. 测线在海底的投影间距**
相邻测线间距为 $d$（水平距离），在倾斜海底面上的投影为：
$$
GG' = \frac{d}{\cos \alpha}
$$

#### **2. 各测线的单侧覆盖宽度**

对于位置 $x-d$ 的测线（测量船1），右侧覆盖宽度：
$$
GF = \frac{D(x-d) \sin(\theta/2)}{\cos(\theta/2) - \sin(\theta/2) \tan \alpha}
$$

对于位置 $x$ 的测线（测量船2），左侧覆盖宽度：
$$
HG' = \frac{D(x) \sin(\theta/2)}{\cos(\theta/2) + \sin(\theta/2) \tan \alpha}
$$

对于位置 $x$ 的测线（测量船2），右侧覆盖宽度：
$$
HI = \frac{D(x) \sin(\theta/2)}{\cos(\theta/2) - \sin(\theta/2) \tan \alpha}
$$

### **重叠区域长度推导**

根据图片中的几何关系：$HF = GG' - GH - FG'$

其中：
- $GH = GG' - HG'$（从G点到H点的距离）
- $FG' = GG' - GF$（从F点到G'点的距离）

因此：
$$
HF = GG' - (GG' - HG') - (GG' - GF) = HG' + GF - GG'
$$

代入具体表达式：
$$
HF = \frac{D(x) \sin(\theta/2)}{\cos(\theta/2) + \sin(\theta/2) \tan \alpha} + \frac{D(x-d) \sin(\theta/2)}{\cos(\theta/2) - \sin(\theta/2) \tan \alpha} - \frac{d}{\cos \alpha}
$$

### **最终重叠率模型**

将重叠区域长度和右侧覆盖宽度代入重叠率定义：

$$
\eta(x) = \frac{HF}{HI} = \frac{\frac{D(x) \sin(\theta/2)}{\cos(\theta/2) + \sin(\theta/2) \tan \alpha} + \frac{D(x-d) \sin(\theta/2)}{\cos(\theta/2) - \sin(\theta/2) \tan \alpha} - \frac{d}{\cos \alpha}}{\frac{D(x) \sin(\theta/2)}{\cos(\theta/2) - \sin(\theta/2) \tan \alpha}}
$$

### **简化形式**

令 $A = \cos(\theta/2) + \sin(\theta/2) \tan \alpha$，$B = \cos(\theta/2) - \sin(\theta/2) \tan \alpha$，则：

$$
\eta(x) = \frac{D(x)}{A} + \frac{D(x-d)}{B} - \frac{d}{B \cos \alpha}
$$

分除以右侧覆盖宽度 $\frac{D(x) \sin(\theta/2)}{B}$，得到：

$$
\boxed{
\eta(x) = \frac{B}{A} + \frac{D(x-d)}{D(x)} - \frac{d}{D(x) \sin(\theta/2) \cos \alpha}
}
$$

### **完整的数学模型总结**

#### **覆盖宽度模型**：
$$
W(x) = D(x) \sin(\theta/2) \left( \frac{1}{\cos(\theta/2) + \sin(\theta/2) \tan \alpha} + \frac{1}{\cos(\theta/2) - \sin(\theta/2) \tan \alpha} \right)
$$

#### **水深变化模型**：
$$
D(x) = D_0 - x \tan \alpha
$$

#### **重叠率模型**：
$$
\eta(x) = \frac{B}{A} + \frac{D(x-d)}{D(x)} - \frac{d}{D(x) \sin(\theta/2) \cos \alpha}
$$

其中：$A = \cos(\theta/2) + \sin(\theta/2) \tan \alpha$，$B = \cos(\theta/2) - \sin(\theta/2) \tan \alpha$
