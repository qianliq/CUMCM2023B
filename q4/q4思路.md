海水深度数据（附件.xlsx）是若干年前某海域（南北长 5 海里、东西宽 4 海里）
单波束测量的测深数据，现希望利用这组数据为多波束测量船的测量布线提供帮助。在设计测
线时，有如下要求：(1) 沿测线扫描形成的条带尽可能地覆盖整个待测海域；(2) 相邻条带之间
的重叠率尽量控制在 20% 以下；(3) 测线的总长度尽可能短。在设计出具体的测线后，请计算
如下指标：(1) 测线的总长度；(2) 漏测海区占总待测海域面积的百分比；(3) 在重叠区域中，
重叠率超过 20% 部分的总长度。


## 基于斜率和方向趋同度的区域分区方法

### 1. 理论基础
沿着等高线测量是多波束测量的最优策略，因为：
- 在等高线方向上，深度变化最小，测量精度最高
- 垂直于等高线方向，深度变化最大，容易产生测量误差

### 2. 分区原则
需要把测量区域分区，分区依据：
- **坡度大小**: 坡度越大，沿等高线测量的重要性越高
- **方向趋同度**: 相邻区域的等高线方向相似程度

### 3. 数学模型

#### 3.1 坡度计算
对于深度数据 $Z(x,y)$，计算梯度：
$$\nabla Z = \left(\frac{\partial Z}{\partial x}, \frac{\partial Z}{\partial y}\right)$$

坡度大小：
$$S(x,y) = |\nabla Z| = \sqrt{\left(\frac{\partial Z}{\partial x}\right)^2 + \left(\frac{\partial Z}{\partial y}\right)^2}$$

#### 3.2 等高线方向
等高线方向（垂直于梯度方向）：
$$\theta(x,y) = \arctan\left(\frac{\partial Z/\partial x}{\partial Z/\partial y}\right) + \frac{\pi}{2}$$

#### 3.3 分区权重函数
构成一个斜率和方向趋同度的函数：
$$W(x,y) = \alpha \cdot f_s(S(x,y)) + \beta \cdot f_d(\theta(x,y))$$

其中：
- $f_s(S)$: 坡度权重函数，$f_s(S) = \tanh(\gamma \cdot S)$
- $f_d(\theta)$: 方向趋同度函数，基于局部方向的标准差
- $\alpha, \beta, \gamma$: 权重参数

### 4. 分区策略
- **高坡度区域** ($S > S_{threshold}$): 平行于等高线变得更加重要，会影响测量的面积效率
- **低坡度区域** ($S \leq S_{threshold}$): 各个方向并没有那么重要，可以把更多方向的纳入同一个区域

### 5. 测线设计准则
- 高坡度区域：测线严格沿等高线方向，间距较密
- 低坡度区域：测线可以采用规则网格，间距较疏
- 过渡区域：采用自适应测线密度

## 多波束测线设计数学模型

### 6. 测线间距优化

#### 6.1 基本约束条件
设多波束扫描宽度为 $W$，测线间距为 $d$，则：

**覆盖约束**：
$$d \leq W \cdot (1 - \text{overlap\_rate})$$

**重叠率约束**：
$$\text{overlap\_rate} = \frac{W - d}{W} \leq 0.2$$

#### 6.2 分区测线密度函数
基于分区权重 $W(x,y)$，定义测线密度：
$$\rho(x,y) = \rho_{\min} + (1 - W(x,y)) \cdot (\rho_{\max} - \rho_{\min})$$

其中：
- $\rho_{\min}$: 最小测线密度（低坡度区域）
- $\rho_{\max}$: 最大测线密度（高坡度区域）

#### 6.3 测线长度最小化目标函数
总测线长度：
$$L_{total} = \sum_{i=1}^{n} \int_{0}^{l_i} \sqrt{1 + \left(\frac{dy_i}{dx_i}\right)^2} dx_i$$

优化目标：
$$\min L_{total} \quad \text{s.t.} \quad \text{Coverage} \geq 95\%, \quad \text{Overlap} \leq 20\%$$

### 7. 计算指标

#### 7.1 测线总长度
$$L_{total} = \sum_{i=1}^{n} l_i$$

#### 7.2 漏测海区百分比
$$P_{miss} = \frac{A_{uncovered}}{A_{total}} \times 100\%$$

#### 7.3 超20%重叠部分长度
对于重叠率 $r > 0.2$ 的区域：
$$L_{excess} = \sum_{j} l_j \cdot (r_j - 0.2) \quad \text{where} \quad r_j > 0.2$$